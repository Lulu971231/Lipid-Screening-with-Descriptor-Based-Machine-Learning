# Lipid-Screening-with-Descriptor-Based-Machine-Learning
README: Lipid Screening with Descriptor-Based Machine Learning
==============================================================

Project Overview
----------------
This project implements a descriptor-based machine learning workflow for virtual lipid screening, aiming to identify promising lipid candidates from a large combinatorial space of molecular components.
The workflow is designed for screening and structure preference analysis, rather than strict model benchmarking. It integrates molecular descriptors, supervised learning, and ensemble-based inference to extract robust structural signals for downstream experimental validation.
The main steps include:
- Molecular descriptor generation from SMILES using PaDEL.
- Feature construction for experimentally measured lipid candidates.
- Binary classification model training with class balancing (SMOTE).
- Large-scale virtual lipid library construction via combinatorial assembly.
- Ensemble XGBoost-based screening of virtual candidates.
- Statistical analysis of component-level occurrence frequencies.
The primary classifier used is XGBoost with GPU acceleration.

Required Python Packages
-------------------------
Make sure the following Python packages are installed:
- pandas
- numpy
- imblearn (imbalanced-learn)
- scikit-learn
- xgboost
- padelpy
- matplotlib (optional, for visualization)

You can install them using pip:

    pip install pandas numpy imbalanced-learn scikit-learn xgboost padelpy matplotlib

Input Files
-----------
The script requires the following input files:

1. basic_smiles.xlsx  
   Excel file containing a column named `SMILES` with SMILES strings of basic molecular components.

2. autodevice-results1215.xlsx  
   Excel file containing experimental data for known lipid formulations, with columns:
- coma-l: Component 1
- comP1-P8: Component 2 
- com1-20: Component 3 
- average: Experimental performance metric
The average column is converted into a binary label:
- Label = 1 if average â‰¥ 50000
- Label = 0 otherwise

Optional:
- basic_descriptors0702.csv  
  CSV file containing pre-calculated molecular descriptors for basic components used in virtual lipid library screening.

Output Files
------------
- basic_descriptors.csv  
  Molecular descriptors generated by PaDEL from basic_smiles.xlsx.

- all_des.csv  
  Feature matrix for experimentally tested lipid formulations, constructed by concatenating descriptors of their three components.

How to Run
----------
1. Ensure that basic_smiles.xlsx and autodevice-results1215.xlsx are present in your working directory.
2. Run gen_descriptors_and_pick_up_model.py.
3. Run pick-component.py.

Output Interpretation
---------------------
At the end of execution, the script prints:
- Top 10 most frequent head groups 
- Top 10 most frequent linkers 
- Top 10 most frequent tail groups

Notes
-----
- PaDEL (used via padelpy) requires Java and must be properly set up in your environment.
- Large virtual libraries and multiple ensemble runs may consume significant memory and GPU resources.
- You can modify the activity threshold (150000) and the ensemble vote threshold (0.6) in the code to suit your data.
- This workflow is designed for virtual screening and structure preference analysis, not for unbiased model benchmarking.
- SMOTE is used to enhance minority class learning and may introduce optimistic bias if used for strict performance evaluation.
- Results should be interpreted as model-guided hypotheses, not definitive predictions.

License
-------
This code is intended for academic and research use only.
